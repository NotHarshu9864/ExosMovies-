<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Doanin</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen">

<header class="fixed top-0 w-full z-50 bg-black/70 backdrop-blur flex items-center p-4">
  <button onclick="toggleMenu()" class="text-2xl mr-4">☰</button>
  <h1 class="text-lg font-bold text-blue-400">Doanin</h1>
</header>

<!-- Sidebar -->
<div id="menu" class="fixed inset-0 bg-black/90 hidden z-50 p-6">
  <button onclick="toggleMenu()" class="text-xl mb-6">✕</button>
  <a class="block py-2 text-lg" href="index.html">Home</a>
  <a class="block py-2 text-lg" href="about.html">About</a>
  <a class="block py-2 text-lg" href="#">Portfolio</a>
</div>

<main class="pt-20 px-4 max-w-7xl mx-auto">

<!-- Search -->
<input id="search"
 class="w-full p-3 mb-4 rounded bg-gray-900 border border-blue-700"
 placeholder="Search movies..." />

<!-- Custom Dropdown -->
<div class="relative mb-6">
  <button onclick="toggleCat()"
   class="w-full bg-gray-900 p-3 rounded border border-blue-700 flex justify-between">
   <span id="catText">All Categories</span> ▼
  </button>

  <div id="catMenu"
   class="absolute w-full bg-black border border-blue-700 rounded hidden z-20"></div>
</div>

<!-- Grid -->
<div id="movies"
 class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>

</main>

<footer class="text-center py-6 text-gray-500 text-sm">
© Doanin
</footer>

<script>
let movies=[], activeCat="all";

function toggleMenu(){ menu.classList.toggle('hidden'); }
function toggleCat(){ catMenu.classList.toggle('hidden'); }

fetch('data/movies/data.json')
.then(r=>r.json())
.then(d=>{
 movies=d;
 renderCategories();
 render();
});

function renderCategories(){
 const cats=[...new Set(movies.map(m=>m.category))];
 catMenu.innerHTML='<div onclick="setCat(\'all\')" class="p-3 hover:bg-blue-900">All</div>';
 cats.forEach(c=>{
  catMenu.innerHTML+=
   `<div onclick="setCat('${c}')" class="p-3 hover:bg-blue-900">${c}</div>`;
 });
}

function setCat(c){
 activeCat=c;
 catText.innerText=c==="all"?"All Categories":c;
 catMenu.classList.add('hidden');
 render();
}

search.oninput=render;

function render(){
 const q=search.value.toLowerCase();
 moviesDiv.innerHTML='';
 movies.filter(m=>
  m.title.toLowerCase().includes(q) &&
  (activeCat==="all"||m.category===activeCat)
 ).forEach(m=>{
  moviesDiv.innerHTML+=`
   <a href="movie.html?id=${m.id}">
    <div class="bg-gray-900 rounded-lg overflow-hidden hover:ring-2 ring-blue-500 transition">
     <img src="${m.poster}" class="h-48 w-full object-cover">
     <div class="p-3">
      <h3 class="text-sm font-semibold">${m.title}</h3>
     </div>
    </div>
   </a>`;
 });
}
</script>

<!-- Security -->
<script>
/* Disable right click */
document.addEventListener('contextmenu', e => e.preventDefault());

/* Disable copy & selection */
['copy','cut','paste'].forEach(ev =>
  document.addEventListener(ev, e => e.preventDefault())
);
document.addEventListener('selectstart', e => e.preventDefault());

/* Disable image drag */
document.addEventListener('dragstart', e => {
  if (e.target.tagName === 'IMG') e.preventDefault();
});

/* DevTools deterrent (not bulletproof) */
setInterval(() => {
  if (window.outerWidth - window.innerWidth > 160 ||
      window.outerHeight - window.innerHeight > 160) {
    document.body.innerHTML =
      "<h1 style='color:white;text-align:center;margin-top:20%'>Access Blocked</h1>";
  }
}, 1000);
</script>

</body>
</html>